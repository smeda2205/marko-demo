'use strict';

var clone = require('clone');

var MASKED_NAMES = [
    'authorization',
    'Authorization'
];

module.exports.sanitize = function sanitize(obj) {
    if (typeof obj === 'object') {
        return MASKED_NAMES.reduce(function reduce(memo, name) {
            if (obj && obj[name] !== undefined) {
                memo = memo || clone(obj);
                memo[name] = '******';
            }
            return memo;
        }, undefined) || obj;
    }
    return obj;
};
