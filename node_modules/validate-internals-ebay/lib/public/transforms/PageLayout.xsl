<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">

<xsl:template name='page-layout'>
<xsl:param name='root-node'/>
<xsl:param name='title-text'/>
<xsl:param name='custom-css'/>
    <html>
    <head>
    <title><xsl:value-of select='$title-text'/></title>
    <style type="text/css" title="currentStyle">
      @import "../css/datatable_jui.css";
      @import "../css/smoothness/jquery-ui-1.8.16.custom.css";
      @import "../css/alerts/jquery.alerts.css";
      @import "../css/page.css";
      <xsl:if test="$root-node/@uiTheme"><xsl:text>
      @import "</xsl:text><xsl:value-of select="$root-node/@uiTheme"></xsl:value-of><xsl:text>";</xsl:text>
      </xsl:if>
    </style>
    <xsl:copy-of select="$custom-css" />
    <script src="../js/jquery.js" type="text/javascript"></script>
    <script src="../js/jQuery.dataTables/jquery.dataTables.js" type="text/javascript"></script>
    <script src="../js/jquery.jeditable.js" type="text/javascript"></script>
    <script src="../js/jquery-ui-1.8.16.custom.min.js" type="text/javascript"></script>
    <script src="../js/jQuery.validate-1.8.1/jquery.validate.js" type="text/javascript"></script>
    <script src="../js/jQuery.dataTables.editable-1.3/jquery.dataTables.editable.js" type="text/javascript"></script>
    <script src="../js/jQuery-alerts/jquery.alerts.js" type="text/javascript"></script>
    <script src="../js/menus.js" type="text/javascript"></script>
    <xsl:choose>
      <xsl:when test="$title-text = 'View Configuration Category'">
        <script src="../js/ViewConfigCategory.js" type="text/javascript"></script>
      </xsl:when>
      <xsl:when test="$title-text = 'Administration Console'">
          <script src="../js/ValidateInternals.js" type="text/javascript"></script>
      </xsl:when>
      <xsl:when test="$title-text = 'View Configuration Bean'">
            <script src="../js/ComponentTable.js" type="text/javascript"></script>
        </xsl:when>
      <xsl:otherwise>
          <script src="../js/ViewConfigCategoryList.js" type="text/javascript"></script>
      </xsl:otherwise>
    </xsl:choose>
    <script language="JavaScript">
        function getLogs(theForm) {
            document.forms[theForm].submit();
        }
    </script>
    </head>
      <body id="vi_page">
        <table id="logoTable">
          <tr>
            <td valign="middle" rowspan="2"><a href="ValidateInternals"><div class="logo_image"/></a></td>
            <td valign="middle" colspan="2"><a href="ValidateInternals"><div class="logo_admin"></div></a></td>
          </tr>
          <tr>
           <td class="space9h">&#160;</td>
           <td>
            <span class="main_sub_title">Host: <xsl:value-of select="$root-node/@host"/></span>
                <xsl:if test="$root-node/@client-ip">
                <span class="main_sub_title">&#160;(client IP <xsl:value-of select="$root-node/@client-ip"/>)</span>
                </xsl:if>
                <xsl:if test="$root-node/@more-info">
                    <xsl:apply-templates select="$root-node/HeaderPH"/>
                </xsl:if>
            </td>
          </tr>
        </table>

        <div id="topMenuDiv">
        <div id="menu1">
        <ul>
                <xsl:apply-templates select="$root-node/HeaderConfig"/>
        </ul>
        </div>
        <xsl:if test="$root-node/Logs/. or $root-node/OldLogs/. or $root-node/CAL/. or $root-node/APOC/.">
        <div id="menu2">
        <ul>
         <li class="more" id="moreLogs"><a id="moreLogsLnk" href="#"><div class="external_link"><div id="moreLogsLink">Logs</div></div></a></li>
        </ul>
        </div>
        </xsl:if>
        </div>
        <xsl:if test="$root-node/Logs/. or $root-node/OldLogs/. or $root-node/CAL/. or $root-node/APOC/. or $root-node/HeapDump/.">
        <div id="moreLogsMenu">
                 <xsl:choose>
                    <xsl:when test="$root-node/Logs/@isProd = 'true'">
                    <li>
                        <a href="javascript:getLogs('ebayLogForm')" title="Logs"><div class="log_link">Log Files</div></a>
                    </li>
                    </xsl:when>
                    <xsl:otherwise>
                      <xsl:if test="$root-node/Logs/.">
                    <li>
                        <a link="none" href="{$root-node/Logs}" title="Logs"><div class="log_link">Log Files</div></a>
                    </li>
                      </xsl:if>
                    </xsl:otherwise>
                </xsl:choose>
                <xsl:if test="$root-node/CAL/.">
                    <li>
                    <a link="none" href="{$root-node/CAL}" title="CAL"><div class="log_link">CAL</div></a>
                    </li>
                </xsl:if>
                <xsl:if test="$root-node/HeapDump/.">
                    <li>
                    <a link="none" href="{$root-node/HeapDump}" title="HeapDump"><div class="log_link">Heap Dump</div></a>
                    </li>
                </xsl:if>
        </div>
        </xsl:if>
        <xsl:if test="$root-node/Warnings">
        <div class="warnings_wrapper">
          <ul>
            <xsl:for-each select="$root-node/Warnings/Warning">
            <li><xsl:value-of select="." /></li>
            <xsl:if test="position() != last()"><div class="warnings_separator"></div></xsl:if>
            </xsl:for-each>
          </ul>
        </div>
        </xsl:if>

        <xsl:if test="$root-node/Logs/@isProd">
            <form name="ebayLogForm" action="{$root-node/Logs}" method="post">
                <input type="hidden" name="caller" value="{$root-node/@client-ip}"/>
            </form>
        </xsl:if>

        <div id="container">

        <xsl:call-template name='page-content'/></div>

        <xsl:if test="$root-node/Errors">
        <div id="popup_errors" title="Configuration update errors">
            <ul>
            <xsl:for-each select="$root-node/Errors/Error">
            <li><xsl:value-of select="." /></li>
            </xsl:for-each>
            </ul>
        </div>
        </xsl:if>
      </body>
    </html>
</xsl:template>

<xsl:template match="HeaderPH">
  <div class="main_sub_title"><xsl:value-of select="@value"/></div>
</xsl:template>

  <!--******************************************************
    ** "HeaderConfig" template used for ValidateInternals headers
    ***************************************************-->
<xsl:template match="HeaderConfig">
  <xsl:variable name="idx"><xsl:value-of select="position()" /></xsl:variable>
  <li id="{$idx}"><a link="none" href="{@href}" title="{@desc}"><xsl:value-of select="@desc"/></a></li>
</xsl:template>
</xsl:stylesheet>
