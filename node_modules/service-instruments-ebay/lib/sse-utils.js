/***
name: utils/index.js
desc: Simple Helpers to find if response is of certain type.
***/

'use strict';
var HDR_TYPE_SSE = 'sse-content-type';
var HDR_CONTENT_TYPE = 'content-type';
var CONTENT_TYPE_JSON = 'application/json';
var MULTIPART_JSON = 'multipart/json';
var TRACKING_DATA = 'TRACKING_DATA';
var EP_DATA = 'EP_DATA';
var TRACKING = 'TRACKING';
var EP = 'EP';

function isValidContentType(headers) {
    var contentType = headers[HDR_CONTENT_TYPE],
        multipartRegexp = new RegExp('^' + MULTIPART_JSON + '(;|$)', 'i');

    return CONTENT_TYPE_JSON === headers[HDR_TYPE_SSE] ||
        multipartRegexp.test(contentType);
}

module.exports.isChunkedResponse = function (res) {
    return res && res.headers && isValidContentType(res.headers);
};

module.exports.isTrackingResponse = function (chunk) {
    return chunk && (TRACKING_DATA === chunk.id || TRACKING === chunk.id);
};

module.exports.isEpResponse = function (chunk) {
    return chunk && (EP_DATA === chunk.id || EP === chunk.id);
};
