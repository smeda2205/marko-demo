#metrics-ebay
[![Build Status](https://ebayci.qa.ebay.com/CI-Instance/buildStatus/icon?job=metrics-ebay)](https://ebayci.qa.ebay.com/CI-Instance/job/metrics-ebay) 
[![Dependency Status](https://nodevalid-i3ey5.vip.lvs01.dev.ebayc3.com/nodejs/metrics-ebay.svg)](https://nodevalid-i3ey5.vip.lvs01.dev.ebayc3.com/nodejs/metrics-ebay)  [![Code Coverage](https://nodevalid-i3ey5.vip.lvs01.dev.ebayc3.com/coverage/nodejs/metrics-ebay)](http://sonar/dashboard/index?id=metrics-ebay)

The module provides common API to collect metrics from different components and publish them as VI status components or to CAL, MCF or other.

## Changelog

See   [CHANGELOG.MD](https://github.corp.ebay.com/nodejs/metrics-ebay/blob/master/CHANGELOG.md#changelog)

## Install
```
npm install metrics-ebay
```

## Usage
```javascript
var Assert = require('assert');
var Metrics = require('metrics-ebay');

var monitor = Metrics.create({
    spec: 'rest',  // specifies metrics spec for rest protocol
    interval: 60000,  // interval to publish metrics data, if omitted, will not publish
    identity: {
        clientId: 'clientX', // rest requires clientId
        pool: 'poolX',       // pool name
        service: 'serviceX', // service name
        operation: 'op'      // operation name
    }
});

// init publishing target for rest profile
Metrics.publishers.cal.init('rest');

// metrics that can be updated as part of the request flow
monitor.update('statusXXX');
monitor.update('status200');
monitor.update('status4XX');
monitor.update('status4XX');
monitor.update('status5XX');
monitor.update('errors');
monitor.update('totalTime', 100);
monitor.update('calls');
```
