# ChangeLog

## v4.0.4
* Fix: should prevent the use of getClient without context to prevent security issue, https://jirap.corp.ebay.com/browse/NODE-1227

## v4.0.2
* Fix: Request to same service multiple times with same context failing.
* Add missing dev dependency.

## v4.0.1
* Upgrade service-instruments-ebay so it doesn't bring in peer dependencies

## v4.0.0
* Remove peer and unwanted dependencies and upgrade dependencies
* Upgraded to a new generic [trooba](https://github.com/dimichgh/trooba) framework (ebay open-source) to handle service operations
* Upgraded to markoV4
* Fixed: https://github.corp.ebay.com/nodejs/service-client-ebay/issues/72

## v1.1.1
* Added changes for switching protocol from `HTTP` to `HTTPS` based on flag `ENABLE_HTTPS` for PCI/RNPCI zones

## v1.1.0
* Multipart json chunking support

## v1.0.9
* Fix for marko v3

## v1.0.8
* Remove clientId from x-ebay-c-enduserctx, same as being done with origUserId.

## v1.0.7
* Adaptor should correctly handle resolution and complete action before done is called.

## v1.0.6
* Add patch support
* Improved Documentation for browser use
* Adding 400 error status and error response values if available from service

## v1.0.4
* Added CSP nonce support
* Added multi-value headers support
* Added tracking instrument to client side
* Sanitize enduser context from user account id

## v1.0.3
* Fixed max call stack exceeded when using provider.context(req).getClient('id')

## v0.1.12
* Fixed: should not share header between requests due to header being defined in client config

## v0.1.11
* Upgraded dependencies

## v0.1.10
* Perf: optimized module root lookup

## v0.1.9
* Enhancement: Changed to send Response Status, Response Headers & Body part of the SSE Callback
* Added soap example.
* Enhancement: Incremented `instrument-ebay` minor version

## v0.1.8
* Enhancement: Enabled to provide support for `path params` for the Service Path

## v0.1.7
* Enhancement: Enabled to use `streams-ebay` module to support SSE, JSON Streams

## v0.1.6
* Allowed to specify custom list of instruments via service client config
```json
"client-with-custom-instruments": {
    "dnslookup": false,
    "socketTimeout": 50,
    "maxKeepAliveTime": 5000,
    "protocol": "http:",
    "hostname": "some.host.com",
    "basepath": "/path/to/resource",
    "transport": "mock-transport",
    "method": "GET",
    "instruments": ["error", "wrap1", "wrap2", "cal"]
}
```

## v0.1.5
* Fixed: http 404 error handling in streams plus more test code coverage (98-100%)

## v0.1.4
* Fixed: options with Buffer data get corrupted.

## v0.1.3
* Changed the way application config bean is definedin config.json
* The module provides simplified API to call ebay REST/COS services.
* In future it will also be used to call SOA and experience COS services with JSON chunking.
* Support to make service call out of request context. Example:

  ```javascript
  var serviceClient = require('service-client-ebay');

  serviceClient.setupContext({
      oauth: {
          'app-name': 'nodedemo1'  // provide app name for authentication if needed
      },
      tracking: false // disable tracking
  },
  function (err, context) {
      assert.ok(!err, err && err.stack);
      // got context similar to req.ebay
      assert.ok(context);
      // mock marketplace id
      context.siteInfo['marketplace-id'] = 'EBAY_DE';

      context.getClient('my-service')
          .get()
          .end(function (err, options) {
              assert.ok(!err, err && err.stack);
          });
  });
  ```
* Provides automatic instrumentation of the service (oauth, COS headers, CAL, tracking, config bean, error handling, circuit breaking, retry).
    For example, here how you can have it retrieve and set oauth toke for your service call

    ```json
    "my-service": {
        "protocol": "http:",
        "hostname": "localhost",
        "port": 7777,
        "transport": "generic",
        "oauth": {
            "app-name": "nodedemo1",
            "scope": "http://api.ebay.com/oauth/scope/@public",
            "token": ["user"]
        }
    }
    ```
* Allows to integrate with any new transport. For example:
  * Eps transport definition: https://github.corp.ebay.com/collections/eps-ebay/blob/master/lib/services/eps-transport.js
  * Registration: https://github.corp.ebay.com/collections/eps-ebay/blob/master/lib/services/eps-transport.js#L50
  * Client configuration: https://github.corp.ebay.com/collections/eps-ebay/blob/master/config/config.json#L20
  * Service invocation: https://github.corp.ebay.com/collections/eps-ebay/blob/master/config/config.json#L20


## v0.1.7
* Added support for SSE
