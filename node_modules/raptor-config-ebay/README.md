#raptor-config-ebay 
[![Build Status](https://ebayci.qa.ebay.com/CI-Instance/buildStatus/icon?job=raptor-config-ebay)](https://ebayci.qa.ebay.com/CI-Instance/job/raptor-config-ebay) [![Dependency Status](https://nodevalid-i3ey5.vip.lvs01.dev.ebayc3.com/nodejs/raptor-config-ebay.svg)](https://nodevalid-i3ey5.vip.lvs01.dev.ebayc3.com/nodejs/raptor-config-ebay)  [![Code Coverage](https://nodevalid-i3ey5.vip.lvs01.dev.ebayc3.com/coverage/nodejs/raptor-config-ebay)](http://sonar/dashboard/index?id=raptor-config-ebay)


raptor config client to load configs from mongo based raptor config service

## Changelog

See   [CHANGELOG.MD](https://github.corp.ebay.com/nodejs/raptor-config-ebay/blob/master/CHANGELOG.md#changelog)

#### Introduction
 * raptor-config module load configs from [raptor config mongo service](https://wiki.vip.corp.ebay.com/display/RAPTOR/Raptor+Config+Mongo+Service+1.2)
 * Also responsible for detecting changes from the mongo service as above and notify the configuration users

#### API
 - `load(opts)` - accepts app configurations for which the data should be loaded and emits 'read' event on emitter.
    - opts should contain following properties
        - `domain` - will be inserted automatically, if not specified
        - `target` - default 'Global'
        - `project` - app name
        - `config` - config name
        - `version` - config version
 - `on('read')` - listen to `read` event to handle the configs when they are loaded

#### Installation

```
npm install raptor-config-ebay
```

#### Usage


```javascript

//import
var RaptorConfig = require('raptor-config-ebay');


//new instance
var raptorConfig = new RaptorConfig();

//Call load function with specific application parameters
raptorConfig.load({
        "domain":"E|qa.ebay.com",
        "target":"Global",
        "project":"searchm",
        "config":"SRPKeywordRedirectTags",
        "version":"1.0.0"
});

//listen to `read` event to handle the configs when they are loaded
raptorConfig.on('read', function(message){
    // process the received message
    
    if (message && !message.error) {
        // Update any in memory cache of the config
        console.log('updating config: ', message);
    } else {
       console.log('Error reading config from raptor configuration service: ', message && message.error);
    }
});

```

#### Config bean for RaptorConfig module

Bean name: node.ebay.config.raptor.config

Update config bean to fetch staged config

Steps:
- got machine:[port]/admin/v3console/ViewConfigCategoryXml?id=node.ebay.config.raptor.config
- Update value to true for Staging property
- click on submit 

(if prod/ preprod pool, use executeURL in altus to do the same)

#### Integration with module-config-inc

[Module config](https://github.corp.ebay.com/nodejs/module-config-inc#raptorconfig) module will take care of loading raptor configs for an app or module. Refer [module-config-inc](https://github.corp.ebay.com/nodejs/module-config-inc#raptorconfig) for details.
