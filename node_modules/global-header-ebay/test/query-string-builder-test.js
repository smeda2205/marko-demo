'use strict';

var chai = require('chai');
chai.config.includeStack = true;
require('chai').should();
// var expect = require('chai').expect;
var chai = require('chai');
var assert = chai.assert;

describe('global-header-ebay/query-string-builder', function () {

    beforeEach(function (done) {
        done();
    });

    it('should generate a header query string correctly', function () {
        var queryStringBuilder = require('../lib/query-string-builder');
        var qs = queryStringBuilder.header({
            app: 'NodeJS',
            human: true,
            hello: 'world',
            siteId: 400,
            secure: true,
            pageId: 999,
            pool: 'test',
            factors: ['a', 'b'],
            mainSiteId: 111,
            language: 'en_US',
            theme: 'my-theme',
            layout: 'FULL',
            categoryId: 222,
            dsVersion: 2
        });

        assert.include(qs, 'app=NodeJS');
        //assert.include(qs, 'hello=world');
        assert.include(qs, 'human=1');
        assert.include(qs, 'siteid=400');
        assert.include(qs, 'secure=1');
        assert.include(qs, 'pageid=999');
        assert.include(qs, 'pool=test');
        assert.include(qs, 'factor=a,b');
        assert.include(qs, 'msiteid=111');
        assert.include(qs, 'lang=en_US');
        assert.include(qs, 'theme=my-theme');
        assert.include(qs, 'type=FULL');
        assert.include(qs, 'categoryid=222');
        assert.include(qs, 'ds=2');
    });

    it('should generate a footer query string correctly', function () {
        var queryStringBuilder = require('../lib/query-string-builder');
        var qs = queryStringBuilder.footer({
            app: 'NodeJS',
            human: true,
            hello: 'world',
            siteId: 400,
            secure: true,
            pageId: 999,
            pool: 'test',
            factors: ['a', 'b'],
            mainSiteId: 111,
            language: 'en_US',
            theme: 'my-theme',
            footerLayout: 'NORMAL',
            categoryId: 222,
            dsVersion: 2
        });

        assert.include(qs, 'app=NodeJS');
        assert.include(qs, 'human=1');
        assert.include(qs, 'siteid=400');
        assert.include(qs, 'pool=test');
        assert.include(qs, 'type=NORMAL');
    });

    it('should generate a footer query string correctly when setting human to false', function () {
        var queryStringBuilder = require('../lib/query-string-builder');
        var qs = queryStringBuilder.footer({
            app: 'NodeJS',
            human: false
        });

        assert.include(qs, 'app=NodeJS');
        assert.include(qs, 'human=0');
    });

    it('should generate a header query string correctly when setting human to false', function () {
        var queryStringBuilder = require('../lib/query-string-builder');
        var qs = queryStringBuilder.header({
            app: 'NodeJS',
            human: false
        });

        assert.include(qs, 'app=NodeJS');
        assert.include(qs, 'human=0');
    });


    describe('Footer',function(){
        var queryStringBuilder = require('../lib/query-string-builder');
        it('should generate a footer query string correctly', function () {
            var qs = queryStringBuilder.footer({
                app: 'NodeJS',
                human: true,
                hello: 'world',
                siteId: 400,
                secure: true,
                pageId: 999,
                pool: 'test',
                factors: ['a', 'b'],
                mainSiteId: 111,
                language: 'en_US',
                theme: 'my-theme',
                layout: 'FULL',
                categoryId: 222,
                dsVersion: 2,footerLayout: 'NORMAL',
            });

            assert.include(qs, 'app=NodeJS');
            //assert.include(qs, 'hello=world');
            assert.include(qs, 'human=1');
            assert.include(qs, 'siteid=400');
            assert.include(qs, 'secure=1');
            assert.include(qs, 'pageid=999');
            assert.include(qs, 'pool=test');
            assert.include(qs, 'factor=a,b');
            assert.include(qs, 'msiteid=111');
            assert.include(qs, 'lang=en_US');
            assert.include(qs, 'theme=my-theme');
            assert.include(qs, 'type=NORMAL');
        });

        it('secure should be added', function () {
            var params = {
                secure: true
            };
            var queryStr = queryStringBuilder.footer(params);
            assert.include(queryStr, 'secure=1');

        });
        it('factor should be added', function () {
            var params = {
                factors: ['aa', 'ab']
            };
            var queryStr = queryStringBuilder.footer(params);
            assert.include(queryStr, 'factor=aa,ab');

        });
    });



});

