'use strict';

var uuid = require('uuid'),
    deployEnv = require('environment-ebay');

module.exports = function getCorrelationId(req) {
    var correlationId = req.headers && req.headers['x-pp-corrid'] || req.correlationId;

    if (!correlationId) {
        var uidRandom = uuid.v4();
        var uidRandomArr = uidRandom.split('-');
        var uidTime = uuid.v1().split('-');
        correlationId = uidTime[0] + uidRandomArr[0].substr(0, 5);
        if (req.headers) {
            req.headers['x-pp-corrid'] = correlationId;
        }
    }
    req.correlationId = correlationId;

    return correlationId;
};
